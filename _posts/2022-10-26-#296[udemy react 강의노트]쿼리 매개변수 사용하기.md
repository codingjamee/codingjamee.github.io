---
title: "#296[udemy react 강의노트]쿼리 매개변수 사용하기"
excerpt: "쿼리 매개변수 등 "
published: true
categories:
  - Blog
tags:
  - [Blog, routing, react, useHistory, useLocation]

toc: true
toc_sticky: false

date: 2022-10-26
last_modified_at: 2022-10-26
---

# 쿼리 매개변수

쿼리 매개변수는 URL의 마지막에 있다.  
URL에 물음표와 함께 매개변수 쌍이 오는 경우가 있는데  
로드된 페이지에 데이터를 추가로 넣어준다.  
quoteId 매개변수와 같은 일반 route매개변수와 다른 점은  
일반 매개변수는 필수로 써야한다.  
QuoteDetail페이지는 id와 segment가 있어야 뜬다.

<br><br>

```jsx
<Route path="/quotes/:quoteId">
  <QuoteDetail />
</Route>
```

그러나 쿼리 매개변수는 선택사항이다. 물음표가 route매칭을 바꾸지 않는다.  
route 매칭에 미치는 영향이 없지만, 어떤 route가 연결되든  
쿼리매개변수 데이터에 접속해서 로드된 페이지의 행동을 바꾼다.
예를들어 QuoteList페이지에서 정렬한다고 치면 id나 연도별로 오름차순 혹은 내림차순으로 정렬하기로 해보자.  
<br><br>

1. 정렬로직이 있는 함수를 추가한다.
2. 쿼리 매개변수를 이용해 정렬한걸 저장한다.  
   쿼리 매개변수가 있는 링크를 공유할 수 있는데,  
   다른 유저가 그 링크를 쓰면 우리가 정렬한 대로 인용문이 자동 정렬된다. 정보를 저장할 수 있다. 정보를 URL에 저장할 수 있고, 그 URL을 쓰면  
   정보에 따라 정렬한다.  
   <br><br>

<br><br>

QuoteList에서 Sort Ascending button을 하나 만들고  
onClick 이벤트 리스너를 만들어 changeSortingHandler함수를 가리킨다.  
<br><br>

```jsx
const QuoteList = (props) => {
  const changeSortingHandler = () => {

  }
```

<br><br>

목표는 인용문 정렬방식을 바꾸는 것이다.  
따라서 useState로 quote를 정렬하는 코드를 실행하고  
state 인용문을 여기에 나타내기로 한다.  
이전의 모습 그대로 사용하지 않고 쿼리 매개변수를 사용하기로 한다.  
<br><br>
<br><br>

## STEP 1. URL을 쿼리매개변수를 추가하여 변경하자.

<br><br>
<br><br>

1. useHistory 훅을 import한다.
   이 훅으로 페이지 history를 바꿀 수 있다.  
    따라서 URL도 바꿀 수 있다.  
    useHistory훅과 return하는 객체를 사용하여 쿼리 매개변수를 페이지에 추가한다.
   <br><br>

```jsx
import { useHistory } from "react-router-dom";
```

<br><br>

2. history.push를 호출한다.  
    push를 호출해야 back버튼으로 마지막 sorting을 쓸 수 있다.  
    변경전의 URL이다.
   <br><br>

```jsx
const QuoteList = (props) => {
  const history = useHistory();
  const changeSortingHandler = () => {
    history.push()
  };
```

<br><br>

3. 현재 로드된 페이지인 새로운 path를 설정하고  
    쿼리 매개변수인 물음표를 추가하고, sort가 어떤 값과 같다고 설정한다.
   <br><br>

```jsx
const QuoteList = (props) => {
  const history = useHistory();
  const changeSortingHandler = () => {
    history.push('/quotes?sort=')
  };
```

<br><br>
sort 라는 key이름은 임의로 설정하면 된다.
<br><br>

4. 만일 우리가 오름차순 정렬이나 내림차순 정렬을 한다면  
    current state에서 얻은 동적 값을 설정한다.  
    지금은 오름차순으로 고정된 코드를 사용하기로 한다.  
    곧 동적 값으로 바뀔 것이다.
   <br><br>

```jsx
const QuoteList = (props) => {
  const history = useHistory();
  const changeSortingHandler = () => {
    history.push("/quotes?sort=asc");
  };
  return (
    <Fragment>
      <div className={classes.sorting}>
        <button onClick={changeSortingHandler}>Sort Ascending</button>
      </div>

```

<br><br>

이제 Sort Ascending 버튼을 클릭하면  
쿼리 매개변수가 추가되어 URL이 변경된 것을 볼 수 있다.
<br><br>
<br><br>

## STEP 2. 쿼리매개변수 값을 읽어 실행하기

<br><br>

1.  useLocation 훅을 import한다.  
     <br>
    useHistory는 history 객체에 접근해 URL을 변경할 수 있게 해주는 반면,  
     useLocation은 location객체에 접속하게 하는데 location 객체엔 최근 로드된 페이지와  
     URL에 대한 정보가 있다.
    <br><br>

2.  useLocation을 location 변수에 할당한다.  
     <br>
    그리고 location을 console.log해보면 객체 안에 몇가지 데이터가 나온다.
    pathname 키에는 경로가 나오고,

    search 라는 키에는 쿼리매개변수 데이터가 나온다.
    <br><br>

```javascript
{pathname: '/quotes', search: '?sort=asc', hash: '', state: undefined, key: 'iby9u2'}
hash : ""
key : "iby9u2"
pathname : "/quotes"
search : "?sort=asc"
state : undefined
```

<br><br>
버튼을 계속 클릭하면 계속 console 창에 찍히는 것을 볼 수가 있는데  
이것으로 보아 history.push가 컴포넌트를 렌더링하는 것을 짐작해볼 수 있다.  
페이지를 push하면 지금 보고있는 페이지라도 페이지 컴포넌트는 재평가 된다.  
react router는 우리가 history를 바꿨다고 생각해  
페이지를 다시 렌더링 하고, 그걸 띄우는 것이다.  
<br><br>

location 객체에는 search 속성에 쿼리매개변수 데이터가 있는데,  
이걸 자바스크립트 객체로 번역해보자.
<br><br>
<br><br>

# URLSearchParams 객체 사용

<br><br>
<br><br>

```jsx
const QuoteList = (props) => {
  const history = useHistory();
  const location = useLocation();

  new URLSearchParams();
```

<br><br>
이것은 브라우저에 원래 있는 함수라서,
